plugin: amazon.aws.aws_ec2
regions:
- us-east-1
filters:
  tag:Name: frontend
  instance-state-name : running
hostnames:
  - private-ip-address
compose:
  # This sets the `ansible_host` variable to connect with the private IP address without changing the hostname.
  ansible_host: private_ip_address
keyed_groups:
  # add hosts to tag_Name_value groups for each aws_ec2 host's tags.Name variable.
  - key: tags.Name
    prefix: "dynamic" # dynamic_frontend
    separator: "_"


# ansible-inventory -i frontend.aws_ec2.yaml --graph
# before executing about playbook, create six ec2-instances with the name frontend manually. 
# What is dynamic inventory
# ----------------------------
# instead of getting Ip address statically, we can pull the Ip address dynamically using aws ansible dynamic inventory plugin.
# we will provide, all the required parameter in yaml file and instead of static inventory file we will give this dynamic inventory plugin to ansible playbook it will fetch the Ip-addresses and it will execute.

# ansible can connect to aws dynamically to fetch the Ip address using dynamic inventory plugin(amazon.aws.aws_ec2), this helps in autoscaling kind of environment, where fetching the IP address statically is not possible.

# plugin: connects to other system and fetch required information